<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Loan Portfolio â€” Pretty (Option A)</title>

  <style>
    :root{
      --muted:#64748b;
      --card:#ffffff;
      --brand:#0ea5e9;
      --accent:#7c3aed;
      --surface:#f8fafc;
    }

    html,body{
      height:100%;
      margin:0;
      font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
      color:#0f172a;
      -webkit-font-smoothing:antialiased;
    }

    body{
      background: linear-gradient(180deg,#f1f5f9 0%, #f8fafc 100%);
    }

    .app{
      max-width:1200px;
      margin:20px auto;
      padding:16px;
    }

    header{
      display:flex;
      flex-direction:column;
      gap:8px;
      margin-bottom:12px;
    }

    .header-top{
      display:flex;
      align-items:center;
      justify-content:space-between;
    }

    h1{ font-size:20px; margin:0; }
    p.lead{ margin:0; color:var(--muted); font-size:13px; }
    .current-date{ font-size:13px; color:var(--muted); margin-top:4px; }

    /* KPI row */
    .kpis{
      display:grid;
      grid-template-columns:repeat(4,1fr);
      gap:12px;
      margin:14px 0 18px;
    }
    .kpi{
      background:var(--card);
      padding:12px;
      border-radius:10px;
      box-shadow:0 6px 18px rgba(16,24,40,0.04);
      border:1px solid rgba(15,23,42,0.04);
      cursor:pointer;
      transition: transform .18s, box-shadow .18s;
    }
    .kpi:hover{ transform:translateY(-6px); box-shadow:0 12px 30px rgba(15,23,42,0.08); }
    .kpi h3{ margin:0; font-size:12px; color:var(--muted) }
    .kpi p{ margin:8px 0 0; font-size:18px; font-weight:700 }

    /* Grid of tiles */
    .grid{
      display:grid;
      grid-template-columns:repeat(2,1fr);
      gap:12px;
      height:calc(100vh - 300px);
      overflow:auto;
      padding-right:6px;
    }
    @media(max-width:900px){
      .grid{ grid-template-columns:1fr; height:auto }
      .kpis{ grid-template-columns:repeat(2,1fr) }
    }

    .tile{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:10px 12px;
      border-radius:12px;
      background:var(--card);
      min-height:110px;
      cursor:pointer;
      overflow:hidden;
      transition: transform .18s ease, box-shadow .18s ease;
    }
    .tile:hover{ transform:translateY(-6px); box-shadow:0 12px 30px rgba(15,23,42,0.08) }

    .tile-left{ flex:1; padding-right:10px }
    .loan-name{ font-weight:700; font-size:14px }
    .loan-sub{ font-size:12px; color:var(--muted); margin-top:6px }
    .loan-meta{ display:flex; gap:8px; font-size:12px; color:var(--muted); margin-top:8px }

    .chart-wrap{ width:170px; flex-shrink:0; display:flex; flex-direction:column; align-items:flex-end }
    .mini-label{ font-size:12px; color:var(--muted); margin-bottom:6px }
    svg.sparkline{ width:170px; height:48px; display:block }

    /* Drawer */
    .drawer{
      position:fixed;
      right:0;
      top:0;
      height:100vh;
      width:560px;
      background:var(--card);
      box-shadow:-28px 0 80px rgba(2,6,23,0.14);
      transform:translateX(110%);
      transition:transform .28s cubic-bezier(.2,.9,.3,1);
      z-index:90;
      overflow:auto;
      padding:20px;
    }
    .drawer.open{ transform:translateX(0) }

    .drawer-head{ display:flex; align-items:start; justify-content:space-between; gap:8px }
    .close-btn{
      background:#f1f5f9;
      border:none;
      padding:8px;
      border-radius:8px;
      cursor:pointer;
    }
    .drawer h2{ margin:0 0 6px; font-size:20px }
    .muted{ color:var(--muted); font-size:13px; margin-bottom:10px }

    .drawer-chart{
      height:220px;
      background:linear-gradient(180deg,#ffffff,#fcfeff);
      border-radius:8px;
      border:1px solid rgba(15,23,42,0.03);
      display:flex;
      align-items:center;
      justify-content:center;
      margin-bottom:8px;
      position:relative;
      padding:8px;
    }

    .legend { display:flex; gap:10px; font-size:12px; align-items:center; margin-top:6px; }
    .legend .item { display:flex; gap:6px; align-items:center; }
    .legend .sw { width:12px; height:8px; border-radius:2px; display:inline-block; }

    .amort-wrap{
      border:1px solid rgba(15,23,42,0.04);
      border-radius:8px;
      padding:8px;
      max-height:40vh;
      overflow:auto;
    }

    table{ width:100%; border-collapse:collapse; font-size:13px }
    thead th{
      position:sticky; top:0; background:var(--card);
      padding:8px; text-align:left; color:var(--muted); font-weight:700;
    }
    td{ padding:8px; border-bottom:1px dashed rgba(15,23,42,0.04); text-align:right }
    td:first-child, th:first-child{ text-align:left }

    .actions{ display:flex; gap:8px; margin-top:12px }
    .btn{ padding:8px 10px; border-radius:8px; border:1px solid rgba(15,23,42,0.06); background:transparent; cursor:pointer; font-weight:600 }
    .btn.primary{ background:linear-gradient(90deg,var(--brand),var(--accent)); color:white; border:none }

    .tooltip{
      position:fixed;
      pointer-events:none;
      background:#0f172a;
      color:white;
      padding:6px 8px;
      border-radius:6px;
      font-size:12px;
      transform:translate(-50%,-120%);
      box-shadow:0 6px 18px rgba(2,6,23,0.2);
      display:none;
      z-index:9999;
      line-height:1.12;
    }

    .small { font-size:12px; color:var(--muted) }
  
/* ROI-style dark mode button */
.theme-icon{
  background:none;
  border:none;
  font-size:20px;
  cursor:pointer;
  color:var(--muted);
  position:absolute;
  top:20px;
  right:20px;
  transition:color .2s ease;
}
.theme-icon:hover{ color:var(--brand); }


/* Moon toggle button */
.theme-icon {
  background: none;
  border: none;
  font-size: 18px;
  cursor: pointer;
  margin-left: 8px;
  color: var(--muted);
}
.theme-icon:hover { color: var(--brand); }

</style>
</head>

<body>
  <div class="app" role="main">
    <header>
      <div class="header-top">
        <div>
          <h1>Loan Portfolio</h1>
          <p class="lead">Compact tiles â€¢ mini-charts show cumulative principal & interest â€¢ KPI drawers & Loan drawers on the right</p>
        </div>
        <div style="display:flex;gap:10px;align-items:center">
          <div style="font-size:13px;color:var(--muted)">Name:<button id="themeToggle" class="theme-icon" title="Toggle dark mode">ðŸŒ™</button>  <strong style="color:var(--brand)">Jeff Customer</strong></div>
        </div>
      </div>

      <div class="current-date">Current Month: <strong id="currentMonthLabel">18</strong> (months since first purchase)</div>
    


</header>


    <section class="kpis" id="kpis"></section>

    <section class="grid" id="loanGrid" aria-live="polite"></section>
  </div>

  <!-- Right drawer -->
  <aside id="drawer" class="drawer" aria-hidden="true">
    <div class="drawer-head">
      <div>
        <h2 id="drawerTitle">Drawer</h2>
        <div class="muted" id="drawerSub">details</div>
      </div>

      <div style="display:flex;gap:8px;align-items:center">
        <button class="btn" id="downloadCsvBtn">Download CSV</button>
        <button class="close-btn" id="closeBtn" aria-label="Close drawer">âœ•</button>
      </div>
    </div>

    <div id="drawerBody">
      <div class="drawer-chart" id="drawerChartArea"></div>
      <div class="legend" id="drawerLegend" style="display:none"></div>

      <div style="display:flex;gap:10px;margin-bottom:8px">
        <div style="flex:1;background:#f8fafc;padding:10px;border-radius:8px">
          <div style="font-size:12px;color:var(--muted)" id="drawerPrimaryTitle">Purchase Price</div>
          <div id="drawerPrimary" style="font-weight:800;font-size:18px"></div>
        </div>
        <div style="width:120px;background:#f8fafc;padding:10px;border-radius:8px">
          <div style="font-size:12px;color:var(--muted)" id="drawerSecondaryTitle">Rate</div>
          <div id="drawerSecondary" style="font-weight:800;font-size:16px"></div>
        </div>
      </div>

      <div id="drawerExtra"></div>

      <div id="drawerAmortContainer">
        <h3 style="margin-top:8px">Amortization</h3>
        <div class="amort-wrap" id="amortWrap">
          <table>
            <thead>
              <tr>
                <th>Month</th><th>Payment</th><th>Principal</th><th>Interest</th><th>Balance</th>
              </tr>
            </thead>
            <tbody id="amortBody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="actions" style="padding-top:10px">
      <button class="btn" id="printBtn">Print</button>
      <button class="btn primary" id="copyCsvBtn">Copy CSV</button>
    </div>
  </aside>

  <div id="tooltip" class="tooltip" role="status" aria-live="polite"></div>

  







<script>
const themeToggle=document.getElementById('themeToggle');
function applyTheme(t){
  document.documentElement.setAttribute('data-theme',t);
  localStorage.setItem('theme',t);
}
const savedTheme=localStorage.getItem('theme')||'light';
applyTheme(savedTheme);
themeToggle?.addEventListener("click", ()=>{
  const newTheme=document.documentElement.getAttribute("data-theme")==="dark"?"light":"dark";
  applyTheme(newTheme);
});
</script>
</body>
</html>
